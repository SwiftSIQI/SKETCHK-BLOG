---
title: Swift Tips 028 - Defining static URLs using string literals
comments: true
date: 2019-11-15 20:10:02
updated:
tags:
  - Swift
  - Tips
categories:
  - Swift
---

æ¯å¤©äº†è§£ä¸€ç‚¹ä¸ä¸€æ ·çš„ Swift å°çŸ¥è¯†

<!-- more -->

## ä»£ç æˆªå›¾

![01.png](01.png)

> ä»£ç å‡ºå¤„: [Swift Tips 028 by John Sundell](https://github.com/JohnSundell/SwiftTips#28-defining-static-urls-using-string-literals)

## å°ç¬”è®°

### è¿™æ®µä»£ç åœ¨è¯´ä»€ä¹ˆ

å›¾ç¤ºé‡Œçš„ä»£ç è®© URL éµå®ˆäº† ExpressibleByStringLiteral åè®®ï¼Œå¹¶é‡å†™äº†å…¶å¯¹åº”çš„æ„é€ å™¨ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡å­—ç¬¦ä¸²çš„å­—é¢é‡ç›´æ¥åˆ›å»º URL å¯¹è±¡ã€‚

å¦‚æœæƒ³åœ¨ Swift 3 ä¹‹å‰å®ç°åŒæ ·çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å®ç° URL çš„ `init(extendedGraphemeClusterLiteral value: StaticString)` å’Œ `init(unicodeScalarLiteral value: StaticString)` æ–¹æ³•ã€‚

> ç¤ºä¾‹ä»£ç é‡Œçš„ require(hint:) æ–¹æ³•å‡ºè‡ª John Sundell ç¼–å†™çš„å¼€æºåº“ [Require](https://github.com/johnsundell/require)ï¼Œè¿™ä¸ªä»“åº“ä¸»è¦çš„åŠŸèƒ½æ˜¯å¸®åŠ©å¼€å‘è€…è½»æ¾åœ°å¤„ç† Optional å€¼ä¸ä¸º nil çš„æƒ…å†µæˆ–è€…ç”± Optional é€ æˆçš„å´©æºƒã€‚

### Literal Type æ˜¯ä»€ä¹ˆ

åœ¨ä¸€äº›å›½å¤–çš„ Swift æ–‡ç« ä¸­ï¼Œç»å¸¸ä¼šæåˆ° Literal Typeï¼Œè¿™é‡Œæˆ‘ä»¬å§‘ä¸”ç§°å®ƒä¸ºå­—é¢é‡ç±»å‹ã€‚

è¦è¯´æ¸…æ¥šå­—é¢é‡ç±»å‹ï¼Œå…ˆè¯´æ˜ä¸€ä¸‹ä»€ä¹ˆæ˜¯ Literal(å­—é¢é‡)ï¼Œ[Wiki é‡Œé¢çš„å®šä¹‰](https://en.wikipedia.org/wiki/Literal_(computer_programming)) æ˜¯è¿™æ ·çš„ã€‚

> Literal (computer programming) -  In computer science, a literal is a notation for representing a fixed value in source code. Almost all programming languages have notations for atomic values such as integers, floating-point numbers, and strings, and usually for booleans and characters; some also have notations for elements of enumerated types and compound values such as arrays, records, and objects. An anonymous function is a literal for the function type.

ç®€å•æ¥è¯´ï¼Œæ‰€è°“çš„å­—é¢é‡ï¼Œå°±æ˜¯æŒ‡ä¸€æ®µèƒ½å¤Ÿè¡¨ç¤ºç‰¹å®šç±»å‹ï¼Œç‰¹å®šå€¼çš„æºä»£ç è¡¨è¾¾å¼ï¼ŒSwift é‡Œé¢çš„ 10ï¼Œ trueï¼Œ â€œHelloâ€ éƒ½æ˜¯å­—é¢é‡ã€‚

åœ¨å¾—åˆ°äº†å­—é¢é‡çš„å®šä¹‰åï¼Œæˆ‘ä»¬å°±å¾ˆå®¹æ˜“å¾—å‡ºå­—é¢ç±»å‹çš„å®šä¹‰äº†ï¼å­—é¢é‡ç±»å‹å°±æ˜¯æ”¯æŒé€šè¿‡å­—é¢é‡è¿›è¡Œå®ä¾‹åˆå§‹åŒ–çš„æ•°æ®ç±»å‹ï¼Œå¦‚ Swift ä¸­çš„ Intï¼ŒBoolï¼ŒString ç±»å‹ã€‚

ä¸‹é¢çš„åˆ—è¡¨ä¸­ï¼Œå±•ç¤ºäº†åœ¨ Swift è¯­è¨€ä¸­ï¼Œå¸¸è§çš„å­—é¢é‡ç±»å‹å’Œå…¶å¯¹åº”çš„å®ä¾‹ï¼š

| å­—é¢é‡ç±»å‹çš„åç§° | é»˜è®¤çš„æ•°æ®ç±»å‹ | ç¤ºä¾‹|
|----------|------------|-----|
| Integer | Int | 123, 0b1010, 0o644, 0xFF, |
| Floating-Point | Double | 3.14, 6.02e23, 0xAp-2 |
| String | String | "Hello", """ . . . """ |
| Extended Grapheme Cluster | Character | "A", "Ã©", "ğŸ‡ºğŸ‡¸" |
| Unicode Scalar | Unicode.Scalar | "A", "Â´", "\u{1F1FA}" |
| Boolean | Bool | true, false |
| Nil | Optional | nil |
| Array | Array | [1, 2, 3] |
| Dictionary | Dictionary | ["a": 1, "b": 2] |

> å°æç¤ºï¼šä¸èƒ½ç›´æ¥ä½¿ç”¨ nil çš„å­—é¢é‡ï¼Œå› ä¸º Swift çš„ç±»å‹æ¨æ–­æ— æ³•ç¡®å®š nil åˆ°åº•æ˜¯ä½•ç§ç±»å‹ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦è¿™æ ·ä½¿ç”¨ nil  å­—é¢é‡
> ```swift
> nil // ! cannot infer type
> let a = nil as String?// Optional<String>.none
> let b: String? = nil
> ```

é™¤äº†æ ‡å‡†åº“ä»¥ä¸ºï¼Œåœ¨ Playground é‡Œé¢è¿˜æœ‰å‡ ä¸ªç‰¹å®šçš„å­—é¢é‡ã€‚

| å­—é¢é‡ç±»å‹çš„åç§° | é»˜è®¤çš„æ•°æ®ç±»å‹ | ç¤ºä¾‹|
|----------|------------|-----|
| Color | NSColor/UIColor | #colorLiteral(red: 1, green: 0, blue: 1, alpha: 1) |
| Image | NSImage / UIImage | #imageLiteral(resourceName: "icon") |
| File | 	URL | #fileLiteral(resourceName: "articles.json") |

### åˆ©ç”¨ Literal Protocol å®ç° Literal Type

æ—¢ç„¶çŸ¥é“äº†å­—é¢é‡ç±»å‹ï¼Œé‚£ä¹ˆæ€ä¹ˆè®©è‡ªå·±åˆ›å»ºçš„æ•°æ®ç±»å‹æ‹¥æœ‰å­—é¢é‡åˆå§‹åŒ–çš„èƒ½åŠ›å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦éµå¾ªå¯¹åº”çš„åè®®å¹¶å®Œæˆè‡ªå·±çš„å®ç°å³å¯ï¼æ‰€ä»¥é—®é¢˜åˆæ¥äº†ï¼Œæœ‰å“ªäº›åè®®æ˜¯å¼€æ”¾ç»™å¼€å‘è€…ä½¿ç”¨çš„å‘¢ï¼Ÿ

* ExpressibleByIntegerLiteral
* ExpressibleByFloatLiteral
* ExpressibleByStringLiteral
* ExpressibleByExtendedGraphemeClusterLiteral
* ExpressibleByUnicodeScalarLiteral
* ExpressibleByBooleanLiteral
* ExpressibleByNilLiteral
* ExpressibleByArrayLiteral
* ExpressibleByDictionaryLiteral

å…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯ `ExpressibleByStringLiteral` ç»§æ‰¿äº† `ExpressibleByExtendedGraphemeClusterLiteral` å’Œ `ExpressibleByUnicodeScalarLiteral` ä¸¤ä¸ªåè®®ã€‚

ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•è®©ä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹æ”¯æŒæ•°å­—å­—é¢é‡åˆå§‹åŒ–å’Œå­—ç¬¦ä¸²å­—é¢é‡åˆå§‹åŒ–ã€‚

```swift
struct Money {
    var value: Double
    init(value: Double) {
        self.value = value
    }
}

// å®ç°ExpressibleByIntegerLiteralå­—é¢é‡åè®®
extension Money: ExpressibleByIntegerLiteral {
    typealias IntegerLiteralType = Int
    public init(integerLiteral value: IntegerLiteralType) {
        self.init(value: Double(value))
    }
}

// å®ç°ExpressibleByStringLiteralå­—é¢é‡åè®®
extension Money: ExpressibleByStringLiteral {
    public init(stringLiteral value: StringLiteralType) {
        if let doubleValue = Double(value) {
            self.init(value: doubleValue)
        } else {
            self.init(value: 0)
        }
    }
}

let intMoney: Money = 10     // é€šè¿‡æ•´æ•°å­—é¢é‡åˆå§‹åŒ–
let strMoney: Money = "10.2" // é€šè¿‡å­—ç¬¦ä¸²å­—é¢é‡åˆå§‹åŒ–
```

### Literal åœ¨ Swift 5 é‡Œçš„è¿›åŒ–

åœ¨ Swift 5 çš„å‘å¸ƒè¿‡ç¨‹ä¸­ï¼Œæ ¸å¿ƒå›¢é˜Ÿæ¥çº³äº†ç¤¾åŒºçš„ [SE-0200](https://github.com/apple/swift-evolution/blob/master/proposals/0200-raw-string-escaping.md) æè®®ï¼Œè¿™ä¸ªæè®®ä¸º Swift æ·»åŠ äº†ä¸åŸå§‹å­—ç¬¦ä¸²å­—é¢é‡(Raw String Literals)ç›¸å…³çš„åŠŸèƒ½ï¼Œåœ¨è¿™é¡¹æè®®ä¸­åæ–œæ (`\`)å’Œäº•å·(`#`)åœ¨æŸäº›åœºæ™¯ä¸‹æ˜¯è¢«å½“ä½œä¸ºæ ‡ç‚¹ç¬¦å·è€Œä¸æ˜¯è½¬ä¹‰å­—ç¬¦æˆ–å­—ç¬¦ä¸²ç»ˆæ­¢ç¬¦ã€‚è¿™ä½¿å¾—è®¸å¤šç”¨æ³•å˜å¾—æ›´å®¹æ˜“ï¼Œç‰¹åˆ«æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚

å…³äºè¿™ä¸ªçŸ¥è¯†ç‚¹å¯ä»¥é˜…è¯» Paul Hudson çš„æ–‡ç«  - [Whatâ€™s new in Swift 5.0
](https://www.hackingwithswift.com/articles/126/whats-new-in-swift-5-0)

Swift 5.0 é‡Œè¿˜æœ‰ä¸€ä¸ªä¸å­—é¢é‡ç›¸å…³çš„æè®® - [SE-0213: Literal initialization via coercion](https://github.com/apple/swift-evolution/blob/master/proposals/0213-literal-init-via-coercion.md)ï¼Œç®€å•æ¥è¯´å®ƒå°±æ˜¯è®©å­—é¢é‡çš„åˆ›å»ºæ›´åŠ åˆç†ï¼Œä¹Ÿæ›´åŠ æœ‰æ•ˆç‡äº†ã€‚

### Literal Protocol å¸¦æ¥çš„å¥½å¤„

é€šè¿‡ä»Šå¤©çš„ Tipsï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥å‘ç°å­—é¢é‡åè®®æ˜¯ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„ä¸œè¥¿ï¼Œé€šè¿‡å®ƒï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥é€šè¿‡ä¸€ä¸ªå­—ç¬¦ä¸²æ¥åˆå§‹åŒ–ä¸€ä¸ª UIViewController ï¼(ä½†æˆ‘ä¼°è®¡ä¸ä¼šæœ‰äººæƒ³è¿™ä¹ˆåš.....)

è™½ç„¶ï¼Œè¿™ç§è‡ªç”±åº¦ç¡®å®å¸¦æ¥äº†è®¸å¤šå¯èƒ½æ€§ï¼Œä½†æˆ‘ç¡®å®æ²¡æœ‰æƒ³åˆ°ååˆ†è´´åˆçš„ä¸šåŠ¡åœºæ™¯ï¼Œä¸è¿‡çŸ¥é“è¿™ä¸ªå°æŠ€å·§è¿˜æ˜¯æ²¡ä»€ä¹ˆä¸å¥½çš„å§ã€‚

å…³äº Literal Protocolï¼Œä½ æœ‰ä»€ä¹ˆå¥½çš„ä½¿ç”¨åœºæ™¯ä¹ˆï¼Ÿ
